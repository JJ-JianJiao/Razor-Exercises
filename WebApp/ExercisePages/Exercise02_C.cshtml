@{
    Layout = "~/_Layout.cshtml";
    Page.Title = string.Format("Razor - {0}", "Exercise 02_C");


    var artistId = Request.QueryString["artistId"];
    if (string.IsNullOrEmpty(artistId)) {
        Response.Redirect("Exercise02_B.cshtml");
    }

    var db = Database.Open("CHINOOK");
    var albumsSqlCmd = @"Select 
                        Albums.AlbumId, 
                        Albums.title, 
                        Albums.ReleaseYear, 
                        Albums.ReleaseLabel, 
                        Artists.ArtistId, 
                        Artists.Name 
                        from Albums, Artists
                        where
                        Albums.ArtistId = @0 
                        AND Artists.ArtistId = @0
                        Order by Albums.title";

    var getArtistNameCmd = @"Select name from artists where artistId =@0";
    var artistName = db.QueryValue(getArtistNameCmd, artistId);
    var resultsAblums = db.Query(albumsSqlCmd, artistId);
    var arr = resultsAblums.ToArray();
    string a = arr.ToString();
    db.Close();
    var gridView = new WebGrid(resultsAblums, rowsPerPage:10);
    //gridView.
    //artistName = gridView.Column().ToString();
}

@section banner {
    <h1>@Page.Title</h1>
}


<div class="offset-1">
    <h3>Albums for Artist:  @artistName</h3>
    <div class="col-11">
        @gridView.GetHtml(
            tableStyle:"table table-striped table-bordered table-hover",
            mode:WebGridPagerModes.All,
            firstText:"Start",
            lastText:"End",
            columns:gridView.Columns(
                gridView.Column(columnName:"Title", header:"Albumn Title"),
                gridView.Column(columnName:"ReleaseYear", header:"Release Year"),
                gridView.Column(columnName:"ReleaseLabel", header:"Release Label")
                //gridView.Column(columnName:"Name", header:"Artist")
            )
       )
    </div>
</div>